---
title: "How about that weather?"
subtitle: "GGPlot with Weather Data"
author: "Jeremy Mikecz"
format: html
editor: visual
---

# Thunderplots: Visualizing Weather Data

## 1. Set up

In this notebook, we will work with some time-series weather data.

When searching for local weather data, I found [*Climate Data Online*](https://www.ncei.noaa.gov/cdo-web/) found on NOAA's National Centers for Environmental Information website. I chose "Hanover", the type of data I wanted, and the date range (earliest to present). Next, I requested this data, and downloaded it from a link they sent me.

With this data, we can run the following code, to create a series of visualizations.

## 1.1 Import necessary packages

```{r}
library(tidyverse)
#install.packages("zoo")
library(zoo)
```

## 1.2 import data

```{r}
year_avgs <- read.csv("../data/Hanover_yearly-temp-averages_long_1894-2024.csv", row.names=1)

tail(year_avgs)
```

# 2. Graph Yearly Temperature Data

```{r}
ggplot() +
    geom_line(data=year_avgs |> filter (type=="maxtemp" & YEAR < 2024), aes(x=YEAR, y=T_yravg), color="red") +
    geom_line(data=year_avgs |> filter (type=="mintemp" & YEAR < 2024), aes(x=YEAR, y=T_yravg), color="blue")
```

## 2.1 Adjust temperature data (long to wide), add color, and a rolling average

```{r}
year_avgs_wide <- year_avgs |>
    pivot_wider(names_from = type, values_from = T_yravg)
```

```{r}
ggplot(year_avgs_wide |> filter(Year<2025), aes(x=Year)) +
    geom_line(aes(y=maxtemp), color="red", size=1, alpha=0.5) + 
    geom_line(aes(y=rollmean(maxtemp, 10, na.pad=TRUE)), linetype="dashed") +
    geom_line(aes(y=mintemp), color="blue", size=1, alpha=0.5)+
    geom_line(aes(y=rollmean(mintemp, 10, na.pad=TRUE)), linetype="dashed")
```

# 3. Daily Weather Data

## 3.1 Import data

```{r}
temps <- read.csv("../../data/Hanover-temps21c_w-daynums.csv")
```

## 3.2 Examine daily temperature data

```{r}
head(temps)
```

```{r}
colnames(temps)
```

## 3.3 Graph one year of daily temp data

```{r}
library(viridis)
ggplot(temps |> filter(Year == 2022), aes(x=daynum, y=maxdiff20c, fill=maxdiff20c)) +
    geom_bar(stat="identity") +
    scale_fill_viridis(option = "plasma")
    #scale_fill_gradient(low = "blue", high = "red")

```

## 3.4 Graph multiple years of daily temp data

```{r fig.width=14, fig.height = 60}
#options(repr.plot.width=30, repr.plot.height=50)
ggplot(temps |> filter(Year>2015), aes(x=daynum, y=maxdiff20c, fill=maxdiff20c)) +
    geom_bar(stat="identity") +
    facet_wrap(~Year, ncol=1) +
    scale_fill_viridis(option = "plasma")
```

::: callout-tip
# CODING ASSIGNMENT Week 2, Notebooks 02-03: Visualizing Weather Data

Create a new Quarto document.

1.  Go to [*Climate Data Online*](https://www.ncei.noaa.gov/cdo-web/) and download weather data for your hometown or a town/ location you have spent some time in. Pose a weather-related question you would like to answer about this location.
2.  Re-create one of the visualizations created in Notebooks 02 and 03 here or create your own visualization to answer your question.
3.  Write a brief paragraph stating the weather-related question you posed and explaining how your visualization helped you answer this question.
4.  **To complete this assignment: Create a brief, clean version of this Quarto document (removing all unnecessary code). Then submit a pdf version of this document to CANVAS. To convert the document into a pdf see the directions below.**
5.  Instructions for converting a Quarto Document (.qmd) into a PDF (for more details see [Quarto: pdf basics](https://quarto.org/docs/output-formats/pdf-basics.html)):
    1.  Place the following format instructions in the YAML header of the document:

        \`\`\``format:`

        `pdf:`

        `documentclass: report`

        `papersize: letter`\`\`\`

    2.  Install **tinytex** if you haven't already. To do so, run `quarto install tinytex` in the terminal.
:::
